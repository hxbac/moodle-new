M.block_admin_presets={tree:null,nodes:null,init:function(Y){Y.use('yui2-treeview',function(Y){var context=M.block_admin_presets;context.tree=new Y.YUI2.widget.TreeView("settings_tree_div");context.nodes=[];context.nodes.root=context.tree.getRoot()})},addNodes:function(Y,ids,nodeids,labels,descriptions,parents){var context=M.block_admin_presets;var nelements=ids.length;for(var i=0;i<nelements;i++){var settingId=ids[i];var nodeId=nodeids[i];var label=decodeURIComponent(labels[i]);var description=decodeURIComponent(descriptions[i]);var parent=parents[i];var newNode=new Y.YUI2.widget.HTMLNode(label,context.nodes[parent]);newNode.settingId=settingId;newNode.setNodesProperty('title',description);newNode.highlightState=1;context.nodes[nodeId]=newNode}},render:function(Y){var context=M.block_admin_presets;var categories=context.tree.getNodesByProperty('settingId','category');if(categories){for(var i=0;i<categories.length;i++){if(!categories[i].hasChildren()){context.tree.popNode(categories[i])}}}
categories=context.tree.getRoot().children;if(categories){for(var j=0;j<categories.length;j++){if(!categories[j].hasChildren()){context.tree.popNode(categories[j])}}}
context.tree.setNodesProperty('propagateHighlightUp',!0);context.tree.setNodesProperty('propagateHighlightDown',!0);context.tree.subscribe('clickEvent',context.tree.onEventToggleHighlight);context.tree.render();Y.YUI2.util.Event.on('id_admin_presets_submit','click',function(){var settingsPresetsForm=document.getElementById('id_admin_presets_submit').parentNode;var hiLit=context.tree.getNodesByProperty('highlightState',1);if(Y.YUI2.lang.isNull(hiLit)){Y.YUI2.log("Nothing selected")}else{var labels=[];for(var i=0;i<hiLit.length;i++){var treeNode=hiLit[i];if(treeNode.settingId!=='category'&&treeNode.settingId!=='page'){labels.push(treeNode.settingId);if(!document.getElementById(treeNode.settingId)){var settingInput=document.createElement('input');settingInput.setAttribute('type','hidden');settingInput.setAttribute('name',treeNode.settingId);settingInput.setAttribute('value','1');settingsPresetsForm.appendChild(settingInput)}}}
Y.YUI2.log("Checked settings:\n"+labels.join("\n"),"info")}})}}